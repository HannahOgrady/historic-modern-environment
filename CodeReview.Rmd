# Soils

## Define Bounds 

This is just a helper function but it could still benefit from some comments, even just a header describing the arguments and output of the function. 

## 1.1 Downloading Soils

Some of the comments in this script are more geared towards what you are doing rather than why you are doing it. For instance, why are you using bounding boxes and quadrants rather than the outline of the state? Is it so that the paleon grids work? I am especially curious because you seem to bind the quadrants back together at the end of this script (lines 471-475).

What does RAT stand for?

Intermediate outputs from this step (gssurgo_average_030_700m.Rdata) would be helpful to have.

The save line (480) points to a folder that does not exist (data/raw/soils). I do not think that the save command can create a new folder in R. Did you move this folder over when you took out the large raw data instead of just moving the data itself? 


## 1.2 Downloading Floodplains

All the state coordinates match those in the previous script. 
All the numbering of variables match up (i.e. no typos in variable assignment). 
Projection types match those in the previous script. 

gSSURGO changed things so I can't do a lot of tests on the outputs of these steps but the provided plotting code seems sufficient to test whether the coordinates fall within the correct states and the floodplains make sense with the geography of each state. 

Intermediate outputs from this step (gssurgo_floodplain_030_700m.Rdata) would be helpful to have. 

Same issue with the save line (541) as in script 1.1. Directory data/raw/soils does not exist. 

## 1.3 Gridded soils

This script loads data from the data/raw/soils folder which is not included in the repo. 

 I still don't have the inputs to this file but the plotting makes sense for checking that the soil data matches spatially and is plausible.
 
Line 64: Here you are using the df_soil data frame. Where is this defined? You seem to have a df_soil3 data frame in line 42, is this what you are plotting? 
 
 I am a little bit confused about the transformation section in lines 80-93. Since you already converted all the data to EPSG:4326 in the previous two scripts why are you now transforming them to a different projection?

Line 98: This is quite nitpicky but it would be helpful to say where in the repo this data is.

Lines 101 & 104: These paths go outside the repository. Could you instead have people download them from the other repository but create a standardized place for them within the R project and provide the path to that location?

Line 114-118: I am confused by this section. From your comments in 106-108 I was expecting this section to find cells that match between the two datasets and remove ones that do not match. However, you seem to be making a list of all the locations that are in one of the two datasets. When do you compare across the two? (i.e. it seems you are finding a union rather than an intersection) Also, do you know why the pls dataset goes from ~47,000 rows in stem_density_agg2 to ~7,000 in pls_grid? Are there lots of plots in the same grid cells?

Line 144: find all soil points within rather than climate. 

Line 251: Are all the rows without clay missing all the soil variables? Are there no lines where only 1 soil variable is NA? 

Line 268: Again, very nitpicky, but since we would expect there to be multiple grid cells that are the same minimum distance from that centroid, do you know how the which.min function treats ties? 

Plots seem sufficient to verify reliability of data processing. 

# Climate

## 2.1 Process Climate

Similar path comments to the previous sections. The read-in data is located outside of the repo so the user would need to edit the paths themselves for the code to run. Also, the saved data in line 63 and re-loaded data in 69 are absolute paths that depend on the user's setup rather than direct paths that would work with any cloned repo.

Line 69: Why are we reloading the data that we just saved? Environment was not cleared. 

Line 132: What is dl? It doesn't appear to occur anywhere else and is outputting an error. 

Line 137: also saved outside the project. 

There are not any trends in the plots that immediately jump out at me other than the fact that everything is highly correlated. However, no obvious formatting errors or reasons to suspect the climate is not processes correctly. 

## 2.2 Gridded Climate
 This one takes forever to run. That's not really a critique, just a thing.
 
 The plots seem both appropriate for checking the data processing and they have no obvious issues.
 
## 2.3 Process Modern Climate

This one took even longer to run. The mid-script saving and loading of the data was helpful for this script. 

Plots seem like a good tool for assessing that data processing makes sense. The plots also do not show any big issues so this processing of climate data seems to be completed successfully. 

## 2.4 Gridded Modern Climate

Since you find the unique grid cells and combine the different data sets in exactly the same way in multiple scripts it may make sense to just save it the first time and load the veg_unique_grid in subsequent analyses. 

Also, it may not be the most important because you have done this analysis several times now but your comments in this section don't really add much understanding of what is happening here. Especially in lines 62 and 67. 

The plots all look good!
